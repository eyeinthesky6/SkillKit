# System Integration: SKILL.md + AGENTS.md + Workflows

**Date:** November 5, 2025  
**Status:** âœ… NO CONFLICTS - All systems work together harmoniously  
**Architecture:** Three complementary layers

---

## ğŸ¯ The Three Systems (How They Work Together)

### 1. SKILL.md (Skill Definition Format)
**Purpose:** Define individual skills in a standard format  
**Used by:** SkillKit registry to load skills  
**Compatible with:** Anthropic's official format

**Example:**
```markdown
---
name: hello-world
version: 1.0.0
description: Simple greeting skill
tags: [example]
inputs: ./input.schema.json
outputs: ./output.schema.json
---

# Hello World Skill

This skill greets the user...
```

### 2. AGENTS.md (IDE Integration)
**Purpose:** Tell IDEs what skills are available  
**Generated by:** `tsk sync` command  
**Used by:** Claude Code, Cursor, Windsurf, etc.

**Example:**
```xml
<available_skills>
<skill>
<name>hello-world</name>
<description>Simple greeting skill</description>
<command>tsk run hello-world</command>
</skill>
</available_skills>
```

### 3. Workflows (Skill Orchestration)
**Purpose:** Chain multiple skills into development workflows  
**Implemented as:** Special skills that call other skills  
**Examples:** BEGIN_SESSION, implement-feature, DEDUP

**Example:**
```yaml
name: begin-session
type: workflow
steps:
  - skill: check-git-status
  - skill: run-diagnostics
  - skill: present-menu
```

---

## ğŸ”„ How They Integrate (The Flow)

### Flow 1: Skill Discovery & Loading
```
1. Developer installs skill
   â†’ Skill has SKILL.md file
   
2. SkillKit loads skill
   â†’ Registry parses SKILL.md (gray-matter)
   â†’ Extracts metadata + instructions
   â†’ Validates schemas
   
3. Skill is registered
   â†’ Available via `tsk run skill-name`
   â†’ Ready for workflow use
```

### Flow 2: IDE Integration
```
1. Developer runs `tsk sync`
   â†’ SkillKit reads all registered skills
   â†’ Generates AGENTS.md
   
2. IDE reads AGENTS.md
   â†’ Claude Code: Shows in marketplace
   â†’ Cursor: Loads as available commands
   â†’ Windsurf: Adds to context
   
3. User in IDE can invoke
   â†’ "Use the hello-world skill"
   â†’ IDE calls: tsk run hello-world
```

### Flow 3: Workflow Execution
```
1. User starts session
   â†’ Runs: BEGIN_SESSION workflow
   
2. BEGIN_SESSION orchestrates
   â†’ Calls: check-git-status skill
   â†’ Calls: run-diagnostics skill
   â†’ Calls: present-menu skill
   
3. Each skill executes
   â†’ Sandboxed execution
   â†’ Validated inputs/outputs
   â†’ Audit logged
```

---

## ğŸ“Š Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        IDE Layer                         â”‚
â”‚  (Claude Code, Cursor, Windsurf)                        â”‚
â”‚                                                           â”‚
â”‚  Reads: AGENTS.md â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SkillKit Runtime                      â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚    Registry    â”‚      â”‚   Orchestrator   â”‚          â”‚
â”‚  â”‚  (Load skills) â”‚â—„â”€â”€â”€â”€â–ºâ”‚  (Run workflows) â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚           â”‚                       â”‚                      â”‚
â”‚           â”‚   Loads               â”‚   Executes           â”‚
â”‚           â†“                       â†“                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚         Skill Collection                â”‚            â”‚
â”‚  â”‚                                          â”‚            â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â” â”‚            â”‚
â”‚  â”‚  â”‚ Regular  â”‚  â”‚ Regular  â”‚  â”‚Work- â”‚ â”‚            â”‚
â”‚  â”‚  â”‚ Skills   â”‚  â”‚ Skills   â”‚  â”‚flows â”‚ â”‚            â”‚
â”‚  â”‚  â”‚(SKILL.md)â”‚  â”‚(SKILL.md)â”‚  â”‚(wf)  â”‚ â”‚            â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜ â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                           â”‚
â”‚  All stored in: examples/skills/ and examples/workflows/ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… No Conflicts - Here's Why

### 1. SKILL.md is the Source of Truth
- âœ… Both regular skills AND workflows use SKILL.md format
- âœ… Single parsing logic (gray-matter) handles both
- âœ… No format conflicts

### 2. AGENTS.md is Auto-Generated
- âœ… Generated from SKILL.md files via `tsk sync`
- âœ… Never edited manually
- âœ… Always stays in sync with skills
- âœ… Just a "view" of the skill registry

### 3. Workflows are Just Special Skills
- âœ… Workflows are skills that call other skills
- âœ… Use same SKILL.md format
- âœ… Same validation, sandboxing, auditing
- âœ… Distinguished by `type: workflow` or `tags: [workflow]`

---

## ğŸ”‘ Key Design Decisions (Why No Conflicts)

### Decision 1: Single Format (SKILL.md)
**Instead of:** Separate formats for skills vs workflows  
**We chose:** Everything is a SKILL.md  
**Benefit:** One parser, one registry, one system

### Decision 2: Workflows as Skills
**Instead of:** Separate workflow engine  
**We chose:** Workflows are special skills  
**Benefit:** Reuse all existing infrastructure

### Decision 3: AGENTS.md is Output Only
**Instead of:** Manual AGENTS.md management  
**We chose:** Auto-generate from registry  
**Benefit:** Never gets out of sync

---

## ğŸ“‚ Directory Structure

```
examples/
â”œâ”€â”€ skills/                    # Regular skills
â”‚   â”œâ”€â”€ hello-world/
â”‚   â”‚   â”œâ”€â”€ SKILL.md           # â† Skill definition
â”‚   â”‚   â”œâ”€â”€ input.schema.json
â”‚   â”‚   â”œâ”€â”€ output.schema.json
â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”œâ”€â”€ file-processor/
â”‚   â”‚   â””â”€â”€ SKILL.md
â”‚   â””â”€â”€ data-transformer/
â”‚       â””â”€â”€ SKILL.md
â”‚
â””â”€â”€ workflows/                 # Workflow skills
    â”œâ”€â”€ begin-session/
    â”‚   â”œâ”€â”€ SKILL.md           # â† Workflow definition
    â”‚   â”œâ”€â”€ input.schema.json
    â”‚   â”œâ”€â”€ output.schema.json
    â”‚   â””â”€â”€ index.js           # Orchestrates other skills
    â”œâ”€â”€ implement-feature/
    â”‚   â””â”€â”€ SKILL.md
    â””â”€â”€ dedup/
        â””â”€â”€ SKILL.md

.cursor/
â””â”€â”€ agents.md                  # â† Auto-generated by `tsk sync`
```

**All use SKILL.md format!** âœ…

---

## ğŸ”„ Example: BEGIN_SESSION Workflow

### As a SKILL.md:
```markdown
---
name: begin-session
version: 1.0.0
description: Start development session with diagnostics
tags: [workflow, session, diagnostics]
type: workflow
inputs: ./input.schema.json
outputs: ./output.schema.json
allowedPaths:
  read: ["./**"]
  write: ["./logs/**"]
allowedCommands: []
steps:
  - Load session context
  - Run diagnostics
  - Present task menu
---

# BEGIN SESSION Workflow

## Step 1: Load Context
Calls: `check-git-status` skill
Calls: `read-tracking-docs` skill

## Step 2: Run Diagnostics
Calls: `adapter.lint()` via framework adapter
Calls: `adapter.typeCheck()`

## Step 3: Present Menu
Returns: Task menu for user
```

### In AGENTS.md (auto-generated):
```xml
<skill>
<name>begin-session</name>
<description>Start development session with diagnostics</description>
<type>workflow</type>
<command>tsk run begin-session</command>
</skill>
```

### In IDE:
User says: "Begin session"  
â†’ IDE calls: `tsk run begin-session`  
â†’ SkillKit orchestrates the workflow

---

## ğŸ¯ Usage Examples

### Example 1: Single Skill
```bash
# Developer
tsk run hello-world --input '{"name":"World"}'

# IDE (reads AGENTS.md)
"Use the hello-world skill"
â†’ Calls: tsk run hello-world
```

### Example 2: Workflow
```bash
# Developer
tsk run begin-session

# IDE
"Begin session"
â†’ Calls: tsk run begin-session
â†’ BEGIN_SESSION orchestrates:
  â”œâ”€ check-git-status
  â”œâ”€ run-diagnostics
  â””â”€ present-menu
```

### Example 3: Sync to IDE
```bash
# Developer
tsk sync

# Result: AGENTS.md generated
<available_skills>
  <skill>hello-world</skill>
  <skill>file-processor</skill>
  <skill>begin-session</skill>
  <skill>implement-feature</skill>
</available_skills>

# IDE automatically picks up all skills!
```

---

## ğŸ”§ Implementation Details

### Registry Handles Both
```typescript
// src/skills/registry.ts
class InMemorySkillRegistry {
  // Loads SKILL.md from any directory
  async loadFromDirectory(dir: string) {
    // Works for both:
    // - examples/skills/hello-world/SKILL.md
    // - examples/workflows/begin-session/SKILL.md
    // Same parsing logic!
  }
}
```

### Orchestrator Identifies Workflows
```typescript
// src/workflow/orchestrator.ts
class WorkflowOrchestrator {
  async run(skill: Skill, input: unknown) {
    if (skill.type === 'workflow' || skill.tags.includes('workflow')) {
      // Special workflow execution
      return this.runWorkflow(skill, input);
    } else {
      // Regular skill execution
      return this.runner.run(skill, input);
    }
  }
}
```

### Sync Generates AGENTS.md
```typescript
// src/cli/sync.ts
async function syncAgentsMD() {
  const skills = registry.list();
  
  const content = `
<available_skills>
${skills.map(skill => `
<skill>
<name>${skill.name}</name>
<description>${skill.description}</description>
<type>${skill.type || 'skill'}</type>
<command>tsk run ${skill.name}</command>
</skill>
`).join('\n')}
</available_skills>
  `;
  
  fs.writeFileSync('.cursor/agents.md', content);
}
```

---

## âœ… Compatibility Matrix

| Feature | Regular Skills | Workflows | AGENTS.md |
|---------|---------------|-----------|-----------|
| Uses SKILL.md format | âœ… | âœ… | N/A (generated) |
| Loaded by registry | âœ… | âœ… | N/A |
| Appears in `tsk list` | âœ… | âœ… | N/A |
| Runnable via `tsk run` | âœ… | âœ… | References both |
| Shows in AGENTS.md | âœ… | âœ… | âœ… |
| Sandboxed execution | âœ… | âœ… (delegates) | N/A |
| Validated I/O | âœ… | âœ… | N/A |
| Audit logged | âœ… | âœ… | N/A |

**Everything is compatible!** âœ…

---

## ğŸš€ Benefits of This Architecture

### 1. Simplicity
- One format (SKILL.md)
- One registry
- One command (`tsk run`)

### 2. Flexibility
- Regular skills: Single operations
- Workflows: Orchestrated operations
- Both work the same way

### 3. IDE Integration
- One AGENTS.md for all
- Auto-generated, always current
- Works in any IDE

### 4. Extensibility
- Easy to add new skills
- Easy to add new workflows
- No conflicts

---

## ğŸ“ Summary

**Question:** Are there conflicts between SKILL.md, AGENTS.md, and workflows?  
**Answer:** âŒ **NO CONFLICTS!**

**How they work together:**
1. **SKILL.md** = Source format for both skills and workflows
2. **AGENTS.md** = Auto-generated index for IDEs
3. **Workflows** = Special skills that orchestrate other skills

**Key insight:** Workflows are just skills with `type: workflow`. They use the same format, same infrastructure, same everything!

**Result:** Clean, simple, no conflicts! âœ…

---

**Next steps:** Continue building framework adapters, which both regular skills and workflows will use! ğŸš€


